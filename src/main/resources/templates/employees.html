<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Employees | HRMS</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{--bg-primary:#0a0e1a;--bg-secondary:#111827;--bg-card:#1a1f35;--bg-hover:#252b45;--accent-cyan:#00d9ff;--accent-blue:#3b82f6;--text-primary:#e6f1fb;--text-secondary:#94a3b8;--text-muted:#64748b;--border-color:#1e293b;--border-accent:rgba(0,217,255,.3)}
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%;font-family:Inter,'Segoe UI',system-ui,sans-serif;background:var(--bg-primary);color:var(--text-primary)}
    .page-wrapper{min-height:100vh;display:flex;flex-direction:column}
    .topbar{position:sticky;top:0;z-index:100;background:linear-gradient(180deg,rgba(10,14,26,.98),rgba(17,24,39,.95));backdrop-filter:blur(12px);border-bottom:1px solid var(--border-color);box-shadow:0 4px 12px rgba(0,0,0,.3)}
    .topbar-inner{max-width:1200px;margin:0 auto;padding:16px 24px;display:flex;justify-content:space-between;align-items:center;gap:24px}
    .brand{display:flex;align-items:center;gap:12px;font-weight:700;font-size:18px;color:var(--accent-cyan);text-decoration:none}
    .brand-dot{width:10px;height:10px;border-radius:50%;background:radial-gradient(circle at 30% 30%,#fff,var(--accent-cyan));box-shadow:0 0 16px var(--accent-cyan);animation:pulse 2s ease-in-out infinite}
    .nav-links{display:flex;gap:12px;align-items:center}
    .nav-link{padding:8px 18px;border-radius:12px;background:rgba(0,217,255,.08);border:1px solid var(--border-accent);color:var(--text-primary);text-decoration:none;font-weight:600;font-size:14px;transition:.3s}
    .nav-link:hover{background:rgba(0,217,255,.15);border-color:var(--accent-cyan);transform:translateY(-2px)}
    .nav-link.active{background:rgba(0,217,255,.2);border-color:var(--accent-cyan)}
    .container{max-width:1200px;margin:0 auto;padding:32px 24px;flex:1}
    .page-header{margin-bottom:24px;animation:fadeIn .5s ease}
    .page-title{font-size:32px;font-weight:800;margin-bottom:8px;background:linear-gradient(135deg,var(--text-primary),var(--accent-cyan));-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}
    .page-subtitle{color:var(--text-secondary);font-size:16px}
    .country-badge{display:inline-block;padding:4px 12px;border-radius:999px;background:rgba(0,217,255,.15);border:1px solid var(--accent-cyan);color:var(--accent-cyan);font-weight:700;font-size:14px}
    .alert-error{padding:16px 20px;border-radius:12px;margin-bottom:24px;border:1px solid #ef4444;background:rgba(239,68,68,.1);color:#fca5a5}
    .controls{display:flex;gap:12px;margin-bottom:24px;flex-wrap:wrap}
    .form-input{flex:1;min-width:280px;padding:10px 14px;border-radius:12px;background:var(--bg-secondary);border:1px solid var(--border-color);color:var(--text-primary);font-size:14px;transition:.3s}
    .form-input:focus{outline:none;border-color:var(--accent-cyan);box-shadow:0 0 0 3px rgba(0,217,255,.1)}
    .btn{padding:10px 20px;border-radius:12px;font-weight:600;font-size:14px;cursor:pointer;transition:.3s;border:1px solid}
    .btn-primary{background:linear-gradient(135deg,var(--accent-cyan),var(--accent-blue));border-color:var(--accent-cyan);color:#fff}
    .btn-primary:hover{box-shadow:0 4px 16px rgba(0,217,255,.4);transform:translateY(-2px)}
    .btn-outline{background:transparent;border-color:var(--border-accent);color:var(--text-primary)}
    .btn-outline:hover{background:rgba(0,217,255,.1);border-color:var(--accent-cyan)}
    .card{background:linear-gradient(135deg,var(--bg-card),var(--bg-secondary));border:1px solid var(--border-color);border-radius:16px;padding:24px;box-shadow:0 8px 24px rgba(0,0,0,.4);animation:fadeIn .6s ease}
    table{width:100%;border-collapse:collapse}
    th{padding:16px;text-align:left;font-weight:700;font-size:13px;text-transform:uppercase;letter-spacing:.5px;color:var(--accent-cyan);background:var(--bg-secondary);border-bottom:2px solid var(--border-color)}
    td{padding:16px;border-bottom:1px solid var(--border-color);color:var(--text-primary)}
    tbody tr{transition:background .2s ease}tbody tr:hover{background:var(--bg-hover)}tbody tr:last-child td{border-bottom:none}
    .footer{margin-top:auto;padding:24px;text-align:center;color:var(--text-muted);font-size:14px;border-top:1px solid var(--border-color)}
    .pagination-container{display:flex;justify-content:space-between;align-items:center;margin-top:24px;padding:16px 0;border-top:1px solid var(--border-color);gap:12px;flex-wrap:wrap}
    .pagination-info{color:var(--text-secondary);font-size:14px}
    .pagination-controls{display:flex;gap:8px;align-items:center}
    .pagination-btn{padding:8px 16px;border-radius:8px;background:var(--bg-secondary);border:1px solid var(--border-color);color:var(--text-primary);cursor:pointer;transition:.3s;font-size:14px}
    .pagination-btn:hover:not(:disabled){background:var(--bg-hover);border-color:var(--accent-cyan)}
    .pagination-btn:disabled{opacity:.5;cursor:not-allowed}
    .pagination-btn.active{background:rgba(0,217,255,.2);border-color:var(--accent-cyan);color:var(--accent-cyan)}
    .pagination-ellipsis{padding:8px 4px;color:var(--text-secondary)}
    .page-size{padding:8px 12px;border-radius:10px;background:var(--bg-secondary);border:1px solid var(--border-color);color:var(--text-primary)}
    .search-controls{display:flex;gap:12px;margin-bottom:24px;flex-wrap:wrap}
    .search-input{flex:1;min-width:300px}
    .search-results-info{color:var(--text-secondary);font-size:14px;margin-bottom:8px}
    @keyframes pulse{0%,100%{transform:scale(.9);opacity:.8}50%{transform:scale(1);opacity:1}}
    @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
    @media (max-width:768px){.topbar-inner{flex-direction:column;gap:16px}.nav-links{width:100%;justify-content:center;flex-wrap:wrap}.page-title{font-size:24px}.controls{flex-direction:column}.search-controls{flex-direction:column}th,td{padding:12px 8px;font-size:13px}.pagination-container{flex-direction:column;gap:16px}}
  </style>
</head>
<body>
  <div class="page-wrapper">
    <header class="topbar">
      <div class="topbar-inner">
        <a href="/" class="brand"><span class="brand-dot"></span>Human Resource Management System</a>
        <nav class="nav-links">
          <a href="/" class="nav-link">Home</a>
          <a href="/regions" class="nav-link">Regions</a>
          <a href="/employees" class="nav-link active">Employees</a>
        </nav>
      </div>
    </header>

    <main class="container">
      <div class="page-header">
        <h1 class="page-title">Employees</h1>
        <p class="page-subtitle">for <span class="country-badge" th:text="${country} ?: '—'">—</span></p>
      </div>

      <div th:if="${error}" class="alert-error">
        <strong>Error:</strong> <span th:text="${error}">Something went wrong</span>
      </div>

      <!-- Search -->
      <div class="search-controls">
        <input id="searchInput" class="form-input search-input" placeholder="Search employees by name, department, city, or email…">
        <button id="clearSearch" class="btn btn-outline" type="button">Clear</button>
      </div>

      <!-- Country filter -->
      <div class="controls">
        <form method="get" action="/employees" style="display:flex;gap:12px;flex-wrap:wrap;flex:1;">
          <input class="form-input" type="text" name="country" placeholder="Country (e.g., Germany)" th:value="${country}">
          <button class="btn btn-primary" type="submit">Load</button>
          <a class="btn btn-outline" href="/regions">Back to Regions</a>
        </form>
        <label style="display:flex;gap:8px;align-items:center">
          <span class="page-subtitle" style="font-size:14px">Rows / page</span>
          <select id="pageSize" class="page-size" aria-label="Rows per page">
            <option value="5">5</option>
            <option value="10" selected>10</option>
            <option value="20">20</option>
            <option value="50">50</option>
          </select>
        </label>
      </div>

      <div id="searchResultsInfo" class="search-results-info" style="display:none;"></div>

      <div class="card">
        <table id="employeesTable">
          <thead>
            <tr>
              <th style="width:70px">ID</th>
              <th>Name</th>
              <th>Dept</th>
              <th>City</th>
              <th>State</th>
              <th>Email</th>
              <th>Phone</th>
            </tr>
          </thead>
          <tbody id="employeesTableBody">
            <tr th:each="e : ${employees}" th:attr="data-row=true">
              <td th:text="${e.employeeId}" style="font-weight:700;color:var(--accent-cyan)">0</td>
              <td th:text="${e.employeeName}" style="font-weight:600">Name</td>
              <td th:text="${e.departmentName}">Dept</td>
              <td th:text="${e.city}">City</td>
              <td th:text="${e.stateProvince}" style="color:var(--text-secondary)">State</td>
              <td th:text="${e.email}">email</td>
              <td th:text="${e.phoneNumber}">phone</td>
            </tr>
            <tr th:if="${#lists.isEmpty(employees)}" id="emptyRow">
              <td colspan="7" style="color:var(--text-muted);text-align:center;">No employees to display.</td>
            </tr>
          </tbody>
        </table>

        <!-- Pagination -->
        <div class="pagination-container">
          <div class="pagination-info" id="paginationInfo">Showing 0 of 0 employees</div>
          <div class="pagination-controls" id="paginationControls"></div>
        </div>
      </div>
    </main>

    <footer class="footer">© 2025 Human Resource Management System • Enterprise Edition</footer>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const body = document.getElementById('employeesTableBody');
      const allRows = Array.from(body.querySelectorAll('tr[data-row="true"]'));
      const emptyRow = document.getElementById('emptyRow');
      const searchInput = document.getElementById('searchInput');
      const clearSearchBtn = document.getElementById('clearSearch');
      const pageSizeSel = document.getElementById('pageSize');
      const info = document.getElementById('paginationInfo');
      const controls = document.getElementById('paginationControls');
      const searchMeta = document.getElementById('searchResultsInfo');

      let filtered = allRows.slice();
      let currentPage = 1;

      function debounce(fn, ms){let t;return (...a)=>{clearTimeout(t);t=setTimeout(()=>fn(...a),ms)}}
      function normalize(s){return (s||'').toString().trim().toLowerCase();}

      function applyFilter() {
        const q = normalize(searchInput.value);
        if (!q) {
          filtered = allRows.slice();
          searchMeta.style.display = 'none';
        } else {
          filtered = allRows.filter(r => normalize(r.textContent).includes(q));
          searchMeta.textContent = `Found ${filtered.length} employee(s) matching "${q}"`;
          searchMeta.style.display = 'block';
        }
        currentPage = 1;
        render();
      }

      function render() {
        const size = parseInt(pageSizeSel.value, 10) || 10;
        const total = filtered.length;
        const pages = Math.max(1, Math.ceil(total / size));
        if (currentPage > pages) currentPage = pages;

        allRows.forEach(r => r.style.display = 'none');
        if (emptyRow) emptyRow.style.display = total === 0 ? '' : 'none';

        if (total > 0) {
          const from = (currentPage - 1) * size;
          const to = Math.min(from + size, total);
          filtered.slice(from, to).forEach(r => r.style.display = '');
          info.textContent = `Showing ${from + 1}-${to} of ${total} employees`;
        } else {
          info.textContent = `Showing 0 of 0 employees`;
        }

        buildPager(pages);
      }

      function buildPager(pages) {
        controls.innerHTML = '';
        const btn = (label, disabled, click, active=false) => {
          const b = document.createElement('button');
          b.type = 'button';
          b.className = 'pagination-btn' + (active ? ' active':'');
          b.textContent = label;
          if (disabled) b.disabled = true;
          b.addEventListener('click', click);
          controls.appendChild(b);
        };

        const pagesCount = Math.max(1, pages);
        btn('Previous', currentPage <= 1 || pagesCount === 0, () => { currentPage--; render(); });

        const windowSize = 5;
        let start = Math.max(1, currentPage - Math.floor(windowSize/2));
        let end = Math.min(pagesCount, start + windowSize - 1);
        if (end - start + 1 < windowSize) start = Math.max(1, end - windowSize + 1);

        if (start > 1) {
          btn('1', false, () => { currentPage = 1; render(); });
          if (start > 2) {
            const span = document.createElement('span');
            span.className = 'pagination-ellipsis';
            span.textContent = '…';
            controls.appendChild(span);
          }
        }

        for (let p = start; p <= end; p++) {
          btn(String(p), false, () => { currentPage = p; render(); }, p === currentPage);
        }

        if (end < pagesCount) {
          if (end < pagesCount - 1) {
            const span = document.createElement('span');
            span.className = 'pagination-ellipsis';
            span.textContent = '…';
            controls.appendChild(span);
          }
          btn(String(pagesCount), false, () => { currentPage = pagesCount; render(); });
        }

        btn('Next', currentPage >= pagesCount || pagesCount === 0, () => { currentPage++; render(); });
      }

      searchInput.addEventListener('input', debounce(applyFilter, 150));
      clearSearchBtn.addEventListener('click', () => { searchInput.value=''; applyFilter(); });
      pageSizeSel.addEventListener('change', () => { currentPage = 1; render(); });

      // Initial paint
      render();
    });
  </script>
</body>
</html>
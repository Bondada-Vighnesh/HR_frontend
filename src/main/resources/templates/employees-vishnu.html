<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
  <meta charset="UTF-8"/>
  <title>Employees for Job | HRMS</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    :root{--bg-primary:#0a0e1a;--bg-secondary:#111827;--bg-card:#1a1f35;--bg-hover:#252b45;--accent-cyan:#00d9ff;--accent-blue:#3b82f6;--text-primary:#e6f1fb;--text-secondary:#94a3b8;--text-muted:#64748b;--border-color:#1e293b;--border-accent:rgba(0,217,255,0.3)}
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%;font-family:'Inter','Segoe UI',system-ui,sans-serif;background:var(--bg-primary);color:var(--text-primary)}
    .page-wrapper{min-height:100vh;display:flex;flex-direction:column}
    .topbar{position:sticky;top:0;z-index:100;background:linear-gradient(180deg,rgba(10,14,26,0.98),rgba(17,24,39,0.95));backdrop-filter:blur(12px);border-bottom:1px solid var(--border-color);box-shadow:0 4px 12px rgba(0,0,0,0.3)}
    .topbar-inner{max-width:1200px;margin:0 auto;padding:16px 24px;display:flex;justify-content:space-between;align-items:center;gap:24px}
    .brand{display:flex;align-items:center;gap:12px;font-weight:700;font-size:18px;color:var(--accent-cyan);text-decoration:none}
    .brand-dot{width:10px;height:10px;border-radius:50%;background:radial-gradient(circle at 30% 30%,#fff,var(--accent-cyan));box-shadow:0 0 16px var(--accent-cyan);animation:pulse 2s ease-in-out infinite}
    .back-link{padding:8px 18px;border-radius:12px;background:rgba(0,217,255,0.08);border:1px solid var(--border-accent);color:var(--text-primary);text-decoration:none;font-weight:600;font-size:14px;transition:all .3s}
    .back-link:hover{background:rgba(0,217,255,0.15);border-color:var(--accent-cyan);transform:translateY(-2px)}
    .container{max-width:1200px;margin:0 auto;padding:32px 24px;flex:1}
    .page-header{margin-bottom:24px;animation:fadeIn .5s ease}
    .page-title{font-size:32px;font-weight:800;margin-bottom:8px;background:linear-gradient(135deg,var(--text-primary),var(--accent-cyan));-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}
    .page-subtitle{color:var(--text-secondary);font-size:16px;margin-bottom:20px}
    .job-badge{display:inline-block;padding:6px 14px;border-radius:999px;background:rgba(0,217,255,0.15);border:1px solid var(--accent-cyan);color:var(--accent-cyan);font-weight:700;font-size:14px}
    .search-form{display:flex;gap:12px;margin-bottom:24px;flex-wrap:wrap}
    .form-input,.form-select{padding:10px 14px;border-radius:12px;background:var(--bg-secondary);border:1px solid var(--border-color);color:var(--text-primary);font-size:14px;transition:all .3s}
    .form-input{flex:1;min-width:260px}
    .form-input:focus,.form-select:focus{outline:none;border-color:var(--accent-cyan);box-shadow:0 0 0 3px rgba(0,217,255,0.1)}
    .btn{padding:10px 20px;border-radius:12px;font-weight:600;font-size:14px;cursor:pointer;transition:all .3s;border:1px solid}
    .btn-primary{background:linear-gradient(135deg,var(--accent-cyan),var(--accent-blue));border-color:var(--accent-cyan);color:#fff}
    .btn-primary:hover{box-shadow:0 4px 16px rgba(0,217,255,0.4);transform:translateY(-2px)}
    .btn-outline{background:transparent;border-color:var(--border-accent);color:var(--text-primary)}
    .btn-outline:hover{background:rgba(0,217,255,0.1);border-color:var(--accent-cyan)}
    .card{background:linear-gradient(135deg,var(--bg-card),var(--bg-secondary));border:1px solid var(--border-color);border-radius:16px;padding:24px;box-shadow:0 8px 24px rgba(0,0,0,0.4);animation:fadeIn .6s ease}
    table{width:100%;border-collapse:collapse}
    th{padding:16px;text-align:left;font-weight:700;font-size:13px;text-transform:uppercase;letter-spacing:.5px;color:var(--accent-cyan);background:var(--bg-secondary);border-bottom:2px solid var(--border-color)}
    th a{color:var(--accent-cyan);text-decoration:none;margin-left:4px;opacity:.6;transition:opacity .3s}
    th a:hover{opacity:1}
    td{padding:16px;border-bottom:1px solid var(--border-color);color:var(--text-primary)}
    tbody tr{transition:background .2s ease}
    tbody tr:hover{background:var(--bg-hover)}
    tbody tr:last-child td{border-bottom:none}
    .pagination{display:flex;justify-content:center;gap:8px;margin-top:24px;flex-wrap:wrap}
    .page-link{padding:8px 14px;border-radius:8px;background:var(--bg-card);border:1px solid var(--border-color);color:var(--text-primary);text-decoration:none;font-weight:600;transition:all .3s}
    .page-link:hover{background:var(--bg-hover);border-color:var(--accent-cyan)}
    .page-link.active{background:var(--accent-cyan);border-color:var(--accent-cyan);color:#000}
    .footer{margin-top:auto;padding:24px;text-align:center;color:var(--text-muted);font-size:14px;border-top:1px solid var(--border-color)}
    @keyframes pulse{0%,100%{transform:scale(.9);opacity:.8}50%{transform:scale(1);opacity:1}}
    @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
    @media (max-width:768px){.page-title{font-size:24px}.search-form{flex-direction:column}th,td{padding:12px 8px;font-size:13px}}
  </style>
</head>
<body>
  <div class="page-wrapper">
    <header class="topbar">
      <div class="topbar-inner">
        <a href="/" class="brand">
          <span class="brand-dot" aria-hidden="true"></span>
          Human Resource Management System
        </a>
        <a th:href="@{/vishnu/jobs}" class="back-link">← Back to Jobs</a>
      </div>
    </header>

    <main class="container">
      <div class="page-header">
        <h1 class="page-title">Employees for Job</h1>
        <p class="page-subtitle">
          Job: <span class="job-badge" th:text="${jobTitle != null && !#strings.isEmpty(jobTitle) ? jobTitle : jobId}">Job Title</span>
          &nbsp;|&nbsp; ID: <strong th:text="${jobId}" style="color: var(--accent-cyan);">JOB_ID</strong>
        </p>
      </div>

      <form class="search-form" th:action="@{|/vishnu/jobs/${jobId}/employees|}" method="get">
        <input type="hidden" name="jobTitle" th:value="${jobTitle}">
        <input class="form-input" type="text" name="q" placeholder="Search name/email/phone/salary..." th:value="${q}">
        <select class="form-select" name="sort">
          <option th:value="employeeId" th:selected="${sort=='employeeId'}">Sort by ID</option>
          <option th:value="fullName" th:selected="${sort=='fullName'}">Sort by Name</option>
          <option th:value="email" th:selected="${sort=='email'}">Sort by Email</option>
          <option th:value="phoneNumber" th:selected="${sort=='phoneNumber'}">Sort by Phone</option>
          <option th:value="salary" th:selected="${sort=='salary'}">Sort by Salary</option>
        </select>
        <select class="form-select" name="dir">
          <option th:value="asc" th:selected="${dir=='asc'}">Asc</option>
          <option th:value="desc" th:selected="${dir=='desc'}">Desc</option>
        </select>
        <select class="form-select" name="size">
          <option th:value="5" th:selected="${size==5}">5</option>
          <option th:value="10" th:selected="${size==10}">10</option>
          <option th:value="20" th:selected="${size==20}">20</option>
          <option th:value="50" th:selected="${size==50}">50</option>
        </select>
        <button class="btn btn-primary" type="submit">Apply</button>
        <a class="btn btn-outline" th:href="@{|/vishnu/jobs/${jobId}/employees?jobTitle=${jobTitle}|}">Clear</a>
      </form>

      <div class="card" th:if="${employees != null and !#lists.isEmpty(employees)}">
        <table aria-label="Employees for job table">
          <thead>
            <tr>
              <th scope="col">
                Emp ID
                <a th:href="@{|/vishnu/jobs/${jobId}/employees?jobTitle=${jobTitle}&sort=employeeId&dir=${dir=='asc'?'desc':'asc'}&q=${q}&page=1&size=${size}|}" aria-label="Sort by ID">⇅</a>
              </th>
              <th scope="col">
                Full Name
                <a th:href="@{|/vishnu/jobs/${jobId}/employees?jobTitle=${jobTitle}&sort=fullName&dir=${dir=='asc'?'desc':'asc'}&q=${q}&page=1&size=${size}|}" aria-label="Sort by Name">⇅</a>
              </th>
              <th scope="col">
                Email
                <a th:href="@{|/vishnu/jobs/${jobId}/employees?jobTitle=${jobTitle}&sort=email&dir=${dir=='asc'?'desc':'asc'}&q=${q}&page=1&size=${size}|}" aria-label="Sort by Email">⇅</a>
              </th>
              <th scope="col">
                Phone
                <a th:href="@{|/vishnu/jobs/${jobId}/employees?jobTitle=${jobTitle}&sort=phoneNumber&dir=${dir=='asc'?'desc':'asc'}&q=${q}&page=1&size=${size}|}" aria-label="Sort by Phone">⇅</a>
              </th>
              <th scope="col">
                Salary
                <a th:href="@{|/vishnu/jobs/${jobId}/employees?jobTitle=${jobTitle}&sort=salary&dir=${dir=='asc'?'desc':'asc'}&q=${q}&page=1&size=${size}|}" aria-label="Sort by Salary">⇅</a>
              </th>
            </tr>
          </thead>
          <tbody>
            <tr th:each="e : ${employees}">
              <td th:text="${e.employeeId}" style="font-weight:700;color:var(--accent-cyan)">100</td>
              <td th:text="${e.fullName}" style="font-weight:600">Steven King</td>
              <td th:text="${e.email}">SKING</td>
              <td th:text="${e.phoneNumber}">1.515.555.0100</td>
              <td th:text="${e.salary != null ? e.salary : '—'}" style="color:var(--text-secondary)">—</td>
            </tr>
          </tbody>
        </table>
      </div>

      <p style="color:var(--text-muted);text-align:center;padding:32px 0;" th:if="${employees == null or #lists.isEmpty(employees)}">
        No results found.
      </p>

      <div class="pagination" th:if="${totalPages > 1}" aria-label="Pagination">
        <a class="page-link" th:classappend="${page==1} ? ' muted' : ''"
           th:href="@{|/vishnu/jobs/${jobId}/employees?jobTitle=${jobTitle}&q=${q}&sort=${sort}&dir=${dir}&size=${size}&page=${page-1}|}">Prev</a>
        <span th:each="p : ${#numbers.sequence(1, totalPages)}">
          <a class="page-link" th:classappend="${p==page} ? ' active' : ''"
             th:href="@{|/vishnu/jobs/${jobId}/employees?jobTitle=${jobTitle}&q=${q}&sort=${sort}&dir=${dir}&size=${size}&page=${p}|}"
             th:text="${p}">1</a>
        </span>
        <a class="page-link" th:classappend="${page==totalPages} ? ' muted' : ''"
           th:href="@{|/vishnu/jobs/${jobId}/employees?jobTitle=${jobTitle}&q=${q}&sort=${sort}&dir=${dir}&size=${size}&page=${page+1}|}">Next</a>
      </div>

      <p style="color:var(--text-muted);text-align:center;margin-top:16px;" th:if="${totalItems != null}">
        <span th:text="${totalItems}">0</span> total result(s)
      </p>

      <p th:if="${error != null}" style="color:#fca5a5;text-align:center;margin-top:16px;" th:text="${error}"></p>
    </main>

    <footer class="footer">© 2025 Human Resource Management System • Enterprise Edition</footer>
  </div>
</body>
</html>